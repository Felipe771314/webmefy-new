{%- assign categories = section.blocks | where: 'type', 'category' -%}

{% capture content %}
  <div class="faq">
    {%- if section.settings.show_navigation and categories.size > 0 -%}
      <div class="faq-navigation hidden-pocket">
        <scroll-spy class="scroll-spy">
          <ul class="scroll-spy__list list--unstyled">
            {%- for category in categories -%}
              <li class="scroll-spy__item">
                <a
                  class="scroll-spy__anchor heading heading--small"
                  href="#category-{{ section.id }}-{{ category.id }}"
                  data-smooth-scroll
                >
                  {{- category.settings.title | escape -}}
                </a>
              </li>
            {%- endfor -%}
          </ul>
        </scroll-spy>
      </div>
    {%- endif -%}

    <div
      class="content-box content-box--{{ section.settings.text_width }}"
      itemscope
      itemtype="https://schema.org/FAQPage"
    >
      {%- for block in section.blocks -%}
        {%- case block.type -%}
          {%- when 'category' -%}
            <{{ block.settings.heading_tag }}
            id="category-{{ section.id }}-{{ block.id }}"
            class="faq__category heading {{ block.settings.heading_size }} anchor"
            {{ block.shopify_attributes }}
            >
              {{- block.settings.title | escape -}}
            </{{ block.settings.heading_tag }}>
          {%- when 'question' -%}
            <div class="faq__item" itemscope itemprop="mainEntity" itemtype="https://schema.org/Question">
              <button
                is="toggle-button"
                class="collapsible-toggle text--strong"
                aria-controls="block-{{ section.id }}-{{ block.id }}"
                aria-expanded="false"
                itemprop="name"
              >
                {{- block.settings.title -}}
                <span class="animated-plus"></span>
              </button>

              <collapsible-content
                id="block-{{ section.id }}-{{ block.id }}"
                class="collapsible anchor"
                itemscope
                itemprop="acceptedAnswer"
                itemtype="https://schema.org/Answer"
                {{ block.shopify_attributes }}
              >
                <div class="collapsible__content text-container" itemprop="text">
                  {{ block.settings.answer }}
                </div>
              </collapsible-content>
            </div>
        {%- endcase -%}
      {%- endfor -%}
    </div>
  </div>
{% endcapture %}

{% render 'section-layout', content: content %}

{% schema %}
{
  "name": "FAQ",
  "class": "shopify-section--faq",
  "disabled_on": {
    "templates": ["password"],
    "groups": ["header", "footer", "custom.overlay"]
  },
  "settings": [
    {
      "type": "checkbox",
      "id": "show_navigation",
      "label": "Show navigation",
      "default": false
    },
    {
      "type": "text",
      "id": "title",
      "label": "Heading",
      "default": "FAQ"
    },
    {
      "type": "select",
      "id": "heading_tag",
      "label": "Heading tag",
      "options": [
        {
          "value": "h1",
          "label": "H1"
        },
        {
          "value": "h2",
          "label": "H2"
        },
        {
          "value": "h3",
          "label": "H3"
        },
        {
          "value": "h4",
          "label": "H4"
        },
        {
          "value": "h5",
          "label": "H5"
        },
        {
          "value": "h6",
          "label": "H6"
        },
        {
          "value": "span",
          "label": "SPAN"
        }
      ],
      "default": "h3"
    },
    {
      "type": "select",
      "id": "heading_size",
      "label": "Heading size",
      "options": [
        {
          "value": "h1",
          "label": "H1"
        },
        {
          "value": "h2",
          "label": "H2"
        },
        {
          "value": "h3",
          "label": "H3"
        },
        {
          "value": "h4",
          "label": "H4"
        },
        {
          "value": "h5",
          "label": "H5"
        },
        {
          "value": "h6",
          "label": "H6"
        },
        {
          "value": "span",
          "label": "SPAN"
        }
      ],
      "default": "h2"
    },
    {
      "type": "select",
      "id": "heading_transform",
      "label": "Text transform",
      "options": [
        {
          "value": "",
          "label": "Default"
        },
        {
          "value": "uppercase",
          "label": "Uppercase"
        },
        {
          "value": "lowercase",
          "label": "Lowercase"
        },
        {
          "value": "capitalize",
          "label": "Capitalize"
        }
      ],
      "default": ""
    },
    {
      "type": "select",
      "id": "heading_weight",
      "label": "Font weight",
      "info": "Does not work if 'Heading' is set to 'Bold' in theme settings",
      "options": [
        {
          "value": "default",
          "label": "Default"
        },
        {
          "value": "normal",
          "label": "Normal"
        },
        {
          "value": "bold",
          "label": "Bold"
        }
      ],
      "default": "default"
    },
    {
      "type": "select",
      "id": "textblock_alignment",
      "label": "Text block alignment",
      "options": [
        {
          "value": "section__header--left",
          "label": "Left"
        },
        {
          "value": "",
          "label": "Center"
        },
        {
          "value": "section__header--right",
          "label": "Right"
        }
      ],
      "default": ""
    },
    {
      "type": "richtext",
      "id": "content",
      "label": "Content"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "block_space",
      "label": "Vertical block space",
      "options": [
        {
          "value": "section--flush",
          "label": "None"
        },
        {
          "value": "section--tight",
          "label": "Small"
        },
        {
          "value": "section",
          "label": "Normal"
        }
      ],
      "default": "section"
    },
    {
      "type": "select",
      "id": "internal_margin",
      "label": "Internal margin",
      "options": [
        {
          "value": "",
          "label": "None"
        },
        {
          "value": "vertical-breather--tight",
          "label": "Small"
        },
        {
          "value": "vertical-breather",
          "label": "Normal"
        }
      ],
      "default": "vertical-breather--tight"
    },
    {
      "type": "select",
      "id": "text_width",
      "label": "Text width",
      "options": [
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "medium",
          "label": "Medium"
        },
        {
          "value": "large",
          "label": "Large"
        },
        {
          "value": "fill",
          "label": "Fill screen"
        }
      ],
      "default": "medium"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background",
      "label": "Background",
      "default": "rgba(0,0,0,0)"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "rgba(0,0,0,0)"
    }
  ],
  "blocks": [
    {
      "type": "category",
      "name": "Category",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Heading",
          "default": "Category"
        },
        {
          "type": "select",
          "id": "heading_tag",
          "label": "Heading tag",
          "options": [
            {
              "value": "h1",
              "label": "H1"
            },
            {
              "value": "h2",
              "label": "H2"
            },
            {
              "value": "h3",
              "label": "H3"
            },
            {
              "value": "h4",
              "label": "H4"
            },
            {
              "value": "h5",
              "label": "H5"
            },
            {
              "value": "h6",
              "label": "H6"
            },
            {
              "value": "span",
              "label": "SPAN"
            }
          ],
          "default": "h3"
        },
        {
          "type": "select",
          "id": "heading_size",
          "label": "Heading size",
          "options": [
            {
              "value": "h1",
              "label": "H1"
            },
            {
              "value": "h2",
              "label": "H2"
            },
            {
              "value": "h3",
              "label": "H3"
            },
            {
              "value": "h4",
              "label": "H4"
            },
            {
              "value": "h5",
              "label": "H5"
            },
            {
              "value": "h6",
              "label": "H6"
            },
            {
              "value": "span",
              "label": "SPAN"
            }
          ],
          "default": "h6"
        }
      ]
    },
    {
      "type": "question",
      "name": "Question",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Question",
          "default": "About your shop"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>Write content to help your customers to better understand your products or policies.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ",
      "blocks": [
        {
          "type": "category",
          "settings": {
            "title": "Shipping"
          }
        },
        {
          "type": "question",
          "settings": {
            "title": "Do you ship overseas?",
            "answer": "<p>Yes, we ship all over the world. Shipping costs will apply, and will be added at checkout. We run discounts and promotions all year, so stay tuned for exclusive deals.</p>"
          }
        },
        {
          "type": "question",
          "settings": {
            "title": "How long will it take to get my order?",
            "answer": "<p>It depends on where you are. Orders processed here will take 5-7 business days to arrive. Overseas deliveries can take anywhere from 7-16 days. Delivery details will be provided in your confirmation email.</p>"
          }
        },
        {
          "type": "category",
          "settings": {
            "title": "Other"
          }
        },
        {
          "type": "question",
          "settings": {
            "title": "Any question?",
            "answer": "<p>You can contact us through our contact page! We will be happy to assist you.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}
