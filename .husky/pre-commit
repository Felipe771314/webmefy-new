#!/bin/sh
set -e  # Detener el script si ocurre cualquier error

echo "ğŸš€ Ejecutando lint, prettier y tests con cobertura..."

# Ejecuta lint-staged; si falla, el script se detendrÃ¡
npx lint-staged

# Ejecuta los tests con cobertura; si falla, se detendrÃ¡
npm test -- --coverage --maxWorkers=2

# EnvÃ­a resultados a SonarQube si el archivo existe
if [ -f "./sonar-project.js" ]; then
  echo "ğŸ“¡ Enviando resultados a SonarQube..."
  node sonar-project.js
fi

echo "âœ… Pre-commit completado correctamente."
